# 🏗️ 餐廳分析器 - 程式架構說明

## 📁 專案結構概覽

```
bigproject/
├── src/main/java/bigproject/          # 主要 Java 源代碼
├── src/main/resources/                # 資源檔案
├── data-collector/                    # Python 數據收集模組
├── dist/                             # 發布檔案
├── scripts/                          # 構建腳本
└── docs/                            # 文檔
```

## 🔧 核心程式模組

### 1. 主程式入口
- **`AppLauncher.java`** - 應用程式主啟動器，處理 AI 初始化和平台檢測
- **`compare.java`** - 主界面控制器，整合所有功能模組

### 2. 用戶界面模組
- **`SearchHomePage.java`** - 搜索首頁，提供餐廳搜索入口
- **`SearchBar.java`** - 智能搜索欄，支持多種搜索方式
- **`RightPanel.java`** - 右側面板，顯示餐廳詳細資訊
- **`TabManager.java`** - 分頁管理器，支持多餐廳同時比較
- **`RecentReviewsSidebar.java`** - 近期評論側邊欄

### 3. 數據管理模組
- **`DataManager.java`** - 數據管理中心，處理餐廳數據的存取
- **`GooglePlacesService.java`** - Google Places API 整合
- **`FirebaseExpenseManager.java`** - Firebase 消費數據管理
- **`RatingDataAnalyzer.java`** - 評分數據分析器

### 4. AI 功能模組
- **`ai/OllamaManager.java`** - Ollama AI 引擎管理
- **`ai/AIChat.java`** - AI 聊天功能
- **`ai/ChatHistoryManager.java`** - 聊天記錄管理
- **`ai/AIProgressDialog.java`** - AI 初始化進度對話框
- **`ai/FirestoreRestaurantAnalyzer.java`** - 基於 Firestore 的餐廳分析

### 5. 用戶設定模組
- **`PreferencesManager.java`** - 用戶偏好設定管理
- **`UIManager.java`** - UI 主題和布局管理
- **`ResourceManager.java`** - 資源檔案管理

### 6. 動畫和視覺效果
- **`AnimationManager.java`** - 動畫效果管理
- **`CustomSplashScreen.java`** - 自定義啟動畫面

### 7. 搜索功能模組
- **`search/AlgoliaRestaurantSearch.java`** - Algolia 搜索整合
- **`LatestReviewsManager.java`** - 最新評論管理

## 🐍 Python 數據收集模組

### 核心收集器
- **`data-collector/featured_collector.py`** - 特色評論收集器
- **`data-collector/search_res_by_name_upload_firebase.py`** - 按名稱搜索並上傳 Firebase
- **`data-collector/search_res_in_area_upload_firebase.py`** - 按區域搜索並上傳
- **`data-collector/update_res_data.py`** - 餐廳數據更新器

### 數據模型
- **`data-collector/restaurant.py`** - 餐廳數據模型
- **`data-collector/review.py`** - 評論數據模型
- **`data-collector/rating_analyzer.py`** - 評分分析器

### 工具模組
- **`data-collector/utils.py`** - 通用工具函數
- **`data-collector/config.py`** - 配置管理

## 📦 資源檔案

### 界面主題
- **`src/main/resources/bigproject/dark_theme.css`** - 深色主題樣式
- **`src/main/resources/bigproject/modern_dark_theme.css`** - 現代深色主題

### 圖標和圖片
- **`src/main/resources/icons/restaurant_icon.png`** - Windows 應用程式圖標
- **`src/main/resources/icons/restaurant_icon.icns`** - macOS 應用程式圖標
- **`應用程式背景.png`** - 應用程式背景圖片

### Firebase 配置
- **`src/main/resources/firebase/Firebase_Admin_SDK.json`** - Firebase 服務帳戶金鑰

## 🔧 建置和發布

### Gradle 配置
- **`build.gradle`** - 主要建置配置，定義依賴和任務
- **`settings.gradle`** - 專案設定
- **`gradlew`** / **`gradlew.bat`** - Gradle Wrapper

### 發布腳本
- **`dist/智能安裝.bat`** - Windows 智能安裝腳本
- **`dist/餐廳分析器-智能安裝版.zip`** - 包含 Java Runtime 的完整包
- **`dist/RestaurantAnalyzer-Working.dmg`** - macOS 安裝包

## 🎯 主要功能流程

### 1. 啟動流程
```
AppLauncher → AI 檢查 → Ollama 初始化 → 主界面顯示
```

### 2. 搜索流程
```
SearchBar → Google Places API → 數據收集 → Firebase 存儲 → 界面顯示
```

### 3. AI 分析流程
```
餐廳數據 → Ollama AI → 分析結果 → ChatHistoryManager → 顯示建議
```

### 4. 數據管理流程
```
Python 收集器 → Firebase → DataManager → UI 組件
```

## 🔗 外部依賴

### Java 依賴
- **JavaFX** - 用戶界面框架
- **JSON** - 數據格式處理
- **Firebase Admin SDK** - Firebase 數據庫連接
- **Google API Client** - Google Services 整合

### Python 依賴
- **requests** - HTTP 請求
- **beautifulsoup4** - HTML 解析
- **firebase-admin** - Firebase 連接
- **python-dotenv** - 環境變數管理

## 📊 數據流向

```
Google Maps → Python 收集器 → Firebase → Java DataManager → UI 顯示
                ↓
            AI 分析 ← Ollama ← 餐廳數據
                ↓
            智能建議 → ChatHistoryManager → AI 聊天界面
```

這個架構確保了餐廳分析器的模組化、可擴展性和維護性。 